package com.example.depanalysis.analysis;

import java.nio.file.Path;
import java.util.List;

import org.springframework.stereotype.Component;

import com.example.depanalysis.dto.FeatureReportSection;
import com.example.depanalysis.dto.VulnerabilityResult;

@Component
public class VulnerabilityFeature implements AnalysisFeature {
    private final JarVulnerabilityChecker checker;

    public VulnerabilityFeature(JarVulnerabilityChecker checker) {
        this.checker = checker;
    }

    @Override
    public FeatureReportSection analyze(Path projectDir) {
        List<VulnerabilityResult> results = checker.checkVulnerabilities(projectDir);
        return new FeatureReportSection(getFeatureName(), results);
    }

    @Override
    public String getFeatureName() {
        return "Vulnerability Scan";
    }
}